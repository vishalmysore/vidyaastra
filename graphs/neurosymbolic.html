<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neuro-Symbolic Systems</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body { margin:0; font-family: Arial, sans-serif; background:#1a1a2e; color:#fff; overflow:hidden; }
        svg { width:100vw; height:100vh; }
        .node circle { stroke:#fff; stroke-width:2px; cursor:pointer; }
        .node text { fill:#fff; font-size:14px; font-weight:bold; pointer-events:none; text-anchor:middle; }
        .link { stroke: #00d9ff; stroke-width:2px; fill:none; marker-end: url(#arrowhead); }
        .info-panel { position:absolute; bottom:20px; right:20px; background:rgba(0,0,0,0.9); padding:15px; border-radius:10px; border:2px solid #00d9ff; max-width:300px; display:none; }
        .info-panel h3 { margin:0 0 10px 0; color:#00d9ff; }
    </style>
</head>
<body>
<svg id="graph"></svg>
<div class="info-panel" id="infoPanel">
    <h3 id="nodeTitle"></h3>
    <p id="nodeDescription"></p>
</div>

<script>
    const nodes = [
        {id:"User Query", type:"user", description:"Input from user, e.g., 'Which threats exploited CVE-2025-1234?'"},
        {id:"Neural LLM", type:"neural", description:"Processes natural language, extracts entities and intent"},
        {id:"Symbolic KG", type:"symbolic", description:"Knowledge Graph / Rule-based reasoner for logical inference and validation"},
        {id:"Integration", type:"integration", description:"LLM queries KG when reasoning is required; combines outputs"},
        {id:"LLM Response", type:"response", description:"Explainable, coherent answer returned to user"}
    ];

    const links = [
        {source:"User Query", target:"Neural LLM"},
        {source:"Neural LLM", target:"Symbolic KG"},
        {source:"Symbolic KG", target:"Integration"},
        {source:"Integration", target:"LLM Response"},
        {source:"Neural LLM", target:"Integration"},
    ];

    const colorMap = { user:"#ff6b6b", neural:"#4ecdc4", symbolic:"#ffe66d", integration:"#95e1d3", response:"#f4a261" };

    const width = window.innerWidth;
    const height = window.innerHeight;

    const svg = d3.select("#graph")
        .attr("width", width)
        .attr("height", height);

    svg.append("defs").append("marker")
        .attr("id","arrowhead")
        .attr("viewBox","0 -5 10 10")
        .attr("refX",20)
        .attr("refY",0)
        .attr("markerWidth",8)
        .attr("markerHeight",8)
        .attr("orient","auto")
        .append("path")
        .attr("d","M0,-5L10,0L0,5")
        .attr("fill","#00d9ff");

    const simulation = d3.forceSimulation(nodes)
        .force("link", d3.forceLink(links).id(d=>d.id).distance(200))
        .force("charge", d3.forceManyBody().strength(-500))
        .force("center", d3.forceCenter(width/2, height/2))
        .force("collision", d3.forceCollide().radius(50));

    const link = svg.append("g")
        .selectAll("path")
        .data(links)
        .enter().append("path")
        .attr("class","link")
        .attr("marker-end","url(#arrowhead)");

    const node = svg.append("g")
        .selectAll("g")
        .data(nodes)
        .enter().append("g")
        .attr("class","node")
        .call(d3.drag()
            .on("start", dragstarted)
            .on("drag", dragged)
            .on("end", dragended))
        .on("click", showInfo);

    node.append("circle")
        .attr("r", 40)
        .attr("fill", d => colorMap[d.type] || "#ccc");

    node.append("text")
        .attr("dy", 5)
        .text(d => d.id);

    simulation.on("tick", () => {
        link.attr("d", d => {
            const dx = d.target.x - d.source.x;
            const dy = d.target.y - d.source.y;
            const dr = Math.sqrt(dx*dx + dy*dy);
            const offsetX = (dx * 20) / dr;
            const offsetY = (dy * 20) / dr;
            return `M${d.source.x},${d.source.y} L${d.target.x - offsetX},${d.target.y - offsetY}`;
        });

        node.attr("transform", d => `translate(${d.x},${d.y})`);
    });

    function dragstarted(event,d){ if(!event.active) simulation.alphaTarget(0.3).restart(); d.fx=d.x; d.fy=d.y; }
    function dragged(event,d){ d.fx=event.x; d.fy=event.y; }
    function dragended(event,d){ if(!event.active) simulation.alphaTarget(0); d.fx=null; d.fy=null; }

    function showInfo(event,d){
        const panel = document.getElementById("infoPanel");
        document.getElementById("nodeTitle").textContent = d.id;
        document.getElementById("nodeDescription").textContent = d.description;
        panel.style.display="block";
    }
</script>
</body>
</html>
